{% extends "sidebar.html" %}

{% block title %}Inventario{% endblock %}

{% block content %}
<main class="contenidoGeneral">
    <div class="contenedorTitulo">
        <h1>Inventario</h1>
    </div>

    <!-- Buscador -->
    <section class="buscador">
        <section id="formBuscador">
            <input type="text" id="buscarNombre" placeholder="Buscar por nombre" name="nombre" oninput="filtrarInventario()">
            <button type="button" class="btnReestablecer" onclick="reestablecerFiltrosInventario()">üîÑ Reestablecer</button>
        </section>
    </section>

    <!-- Tabla de Inventario -->
    <div class="contenedorInventario">
        <section class="listaInventario">
            <table>
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Stock</th>
                        <th>Stock M√≠nimo</th>
                        <th>Stock M√°ximo</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="inventarioLista">
                    {% if productos %}
                        {% for producto in productos %}
                        <tr data-id="{{ producto.Id }}" data-nombre="{{ producto.nombre_producto }}" data-stock="{{ producto.stock }}" data-stock-min="{{ producto.stock_minimo }}" data-stock-max="{{ producto.stock_maximo }}">
                            <td>{{ producto.nombre_producto }}</td>
                            <td class="stockProducto">{{ producto.stock }}</td>
                            <td class="stockMinProducto">{{ producto.stock_minimo }}</td>
                            <td class="stockMaxProducto">{{ producto.stock_maximo }}</td>
                            <td>
                                <button class="btnEditarInventario" onclick="editarInventario(this)">‚úèÔ∏è</button>
                            </td>
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="5" class="text-center">No hay productos que requieran inventario</td>
                        </tr>
                    {% endif %}
                </tbody>
            </table>
        </section>

        <!-- Modal de Editar Inventario -->
        <section class="modal" id="editarInventarioModal" style="display: none;">
            <section class="contenedorModal">
                <span class="cerrar" onclick="cerrarEditarInventario()">&times;</span>
                <h3 class="tituloModal">Editar Inventario</h3>

                <form id="formProducto">
                    <input type="hidden" id="idProducto" name="id">

                    <section class="contenedorIzquierdo">
                        <p><strong>Nombre:</strong> <span id="verNombreProducto"></span></p>

                        <label for="editarStockInventario">Stock Actual:</label>
                        <input type="number" id="editarStockInventario" name="stock" disabled>

                        <label for="editarStockMinInventario">Stock M√≠nimo Actual:</label>
                        <input type="number" id="editarStockMinInventario" name="stock_minimo" min="0" disabled>

                        <label for="editarStockMaxInventario">Stock M√°ximo Actual:</label>
                        <input type="number" id="editarStockMaxInventario" name="stock_maximo" min="0" disabled>
                    </section>

                    <section class="contenedorDerecho">
                        <br>
                        <br>
                        <br>
                        <label for="agregarStockInventario">Ajustar Stock (+ / -):</label>
                        <input type="number" id="agregarStockInventario" name="agregar_stock">

                        <label for="agregarStockMinimoInventario">Actualizar Stock M√≠nimo:</label>
                        <input type="number" id="agregarStockMinimoInventario" name="agregar_stock_min" min="0">

                        <label for="agregarStockMaximoInventario">Actualizar Stock M√°ximo:</label>
                        <input type="number" id="agregarStockMaximoInventario" name="agregar_stock_max" min="0">

                        <button class="guardarBtn" type="submit">Guardar</button>
                    </section>
                </form>
            </section>
        </section>
    </div>

    <script src="{{ url_for('static', filename='js/inventario.js') }}"></script>
</main>
{% endblock %}
